<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Porto - Bootstrap eCommerce Template</title>

    <meta name="keywords" content="HTML5 Template" />
    <meta name="description" content="Porto - Bootstrap eCommerce Template">
    <meta name="author" content="SW-THEMES">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/usr/images/logo-dear.png">

    <script>
        WebFontConfig = {
            google: { families: [ 'Open+Sans:300,400,600,700,800', 'Poppins:300,400,500,600,700' ] }
        };
        ( function ( d ) {
            var wf = d.createElement( 'script' ), s = d.scripts[ 0 ];
            wf.src = '/usr/js/webfont.js';
            wf.async = true;
            s.parentNode.insertBefore( wf, s );
        } )( document );
    </script>

    <!-- Plugins CSS File -->
    <link rel="stylesheet" href="/usr/css/bootstrap.min.css">

    <!-- Main CSS File -->
    <link rel="stylesheet" href="/usr/css/demo3.min.css">
    <link rel="stylesheet" type="text/css" href="/usr/vendor/fontawesome-free/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/usr/vendor/simple-line-icons/css/simple-line-icons.min.css">
</head>

<body class="full-screen-slider">
    <div class="page-wrapper">
        <div th:replace="~{/usr/infra/v1/include/Header :: Header}"></div>


        <main class="main">
            <div class="container pt-120">
                <nav aria-label="breadcrumb" class="breadcrumb-nav" style="padding-top : 100px">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a><i class="icon-home"></i></a></li>
                        <li class="breadcrumb-item"><a>Shop</a></li>
                        <li class="breadcrumb-item"><a th:text="${product.ProductName}"></a></li>
                    </ol>
                </nav>
                <div class="product-single-container product-single-default">
                    <div class="cart-message d-none">
                        <strong class="single-cart-notice">â€œMen Black Sports Shoesâ€</strong>
                        <span>has been added to your cart.</span>
                    </div>

                    <div class="row">
                        <div class="col-lg-5 col-md-6 product-single-gallery">
                            <div class="product-slider-container">
<!-- 								<div class="label-group">
								    <div th:if="${product != null and (product.prodStockCD == 7)}" class="product-label label-hot">NEW</div>
								    <div th:if="${product != null and (product.prodStockCD == 8)}" class="product-label label-sale">BEST</div>
								    <div th:if="${product != null and (product.prodStockCD == 9)}" class="product-label " style="background-color: rgb(96, 133, 165);">RESTOCK</div>
								</div> -->
                                <div class="product-single-carousel owl-carousel owl-theme show-nav-hover">
                                    <div class="product-item">
                                        <img class="product-single-image" src="/usr/images/products/zoom/mj1.jpg" data-zoom-image="/usr/images/products/zoom/mj1.jpg" width="468" height="468" alt="product" />
                                    </div>
                                    <div class="product-item">
                                        <img class="product-single-image" src="/usr/images/products/zoom/mj2.jpg" data-zoom-image="/usr/images/products/zoom/mj2.jpg" width="468" height="468" alt="product" />
                                    </div>
                                    <div class="product-item">
                                        <img class="product-single-image" src="/usr/images/products/zoom/mj3.jpg" data-zoom-image="/usr/images/products/zoom/mj3.jpg" width="468" height="468" alt="product" />
                                    </div>
                                    <div class="product-item">
                                        <img class="product-single-image" src="/usr/images/products/zoom/mj4.jpg" data-zoom-image="/usr/images/products/zoom/mj4.jpg" width="468" height="468" alt="product" />
                                    </div>
                                  
                                </div>
                                <!-- End .product-single-carousel -->
                                <span class="prod-full-screen">
                                    <i class="icon-plus"></i>
                                </span>
                            </div>

                            <div class="prod-thumbnail owl-dots">
                                <div class="owl-dot">
                                    <img src="/usr/images/products/zoom/mj1.jpg" width="110" height="110" alt="product-thumbnail" />
                                </div>
                                <div class="owl-dot">
                                    <img src="/usr/images/products/zoom/mj2.jpg" width="110" height="110" alt="product-thumbnail" />
                                </div>
                                <div class="owl-dot">
                                    <img src="/usr/images/products/zoom/mj3.jpg" width="110" height="110" alt="product-thumbnail" />
                                </div>
                                <div class="owl-dot">
                                    <img src="/usr/images/products/zoom/mj4.jpg" width="110" height="110" alt="product-thumbnail" />
                                </div>
                            </div>
                        </div>
                        <!-- End .product-single-gallery -->

                        <div class="col-lg-7 col-md-6 product-single-details">

                                    <strong>
                                      			<a th:if="${product.category1CD != null}" th:text="${@codeService.selectOneCachedCode(product.category1CD)}"></a>
						                        <a th:unless="${product.category1CD != null}" th:text="${product.category1CD}"></a>
						                        <a th:if="${product.category2CD != null}" th:text="${@codeService.selectOneCachedCode(product.category2CD)}"></a>
						                        <a th:unless="${product.category2CD != null}" th:text="${product.category2CD}"></a>
						            </strong>
                            <h1 class="product-title" th:text="${product.ProductName}"></h1>
                            
							<!-- ì‘ê²Œ ì „í›„ ìƒí’ˆìœ¼ë¡œ ì´ë™í•  ìˆ˜ ìˆëŠ” ê³³. í˜„ì¬ ìƒí’ˆ seq +1, -1ì¸ ìƒí’ˆì˜ ì •ë³´ë¥¼ ë„£ìœ¼ë©´ ì¢‹ì„ë“¯ -->
                            <div class="product-nav">
                                <div class="product-prev">
                                    <a href="#">
                                        <span class="product-link"></span>

                                        <span class="product-popup">
                                            <span class="box-content">
                                                <img alt="product" width="150" height="150"
                                                    src="/usr/images/products/product-3.jpg"
                                                    style="padding-top: 0px;">

                                                <span>Circled Ultimate 3D Speaker</span>
                                        </span>
                                        </span>
                                    </a>
                                </div>

                                <div class="product-next">
                                    <a href="#">
                                        <span class="product-link"></span>

                                        <span class="product-popup">
                                            <span class="box-content">
                                                <img alt="product" width="150" height="150"
                                                    src="/usr/images/products/product-4.jpg"
                                                    style="padding-top: 0px;">

                                                <span>Blue Backpack for the Young</span>
                                        </span>
                                        </span>
                                    </a>
                                </div>
                            </div>
                            <!-- ìš”ê¸°ê¹Œì§€ ì „í›„ ìƒí’ˆ -->
	
                            <div class="ratings-container" >
                            	<div class="product-ratings">
                                     <span class="ratings" th:if="${product.reviewRateAvg==5}" style="width:100%"></span>
                                     <span class="ratings" th:if="${product.reviewRateAvg==4.5}" style="width:90%"></span>
								     <span class="ratings" th:if="${product.reviewRateAvg==4}" style="width:80%"></span>
								     <span class="ratings" th:if="${product.reviewRateAvg==3.5}" style="width:70%"></span>
								     <span class="ratings" th:if="${product.reviewRateAvg==3}" style="width:60%"></span>
								     <span class="ratings" th:if="${product.reviewRateAvg==2.5}" style="width:50%"></span>
								     <span class="ratings" th:if="${product.reviewRateAvg==2}" style="width:40%"></span>
								     <span class="ratings" th:if="${product.reviewRateAvg==1.5}" style="width:30%"></span>
								     <span class="ratings" th:if="${product.reviewRateAvg==1}" style="width:20%"></span>
								     <span class="ratings" th:if="${product.reviewRateAvg==0.5}" style="width:10%"></span>
									 <span class="ratings" th:if="${product.reviewRateAvg==null}" style="width:0%"></span>
                                    <span class="tooltiptext tooltip-top"></span>
                                </div>
		                           
                                <a style="padding : 0; margin : 0;" href="#" class="rating-link" th:text="'(' + ${product.totalReviewCount} + ' Reviews)'" ></a>
                            </div>
                            <!-- End .ratings-container -->

                            <hr class="short-divider">

                            <div class="price-box">
                                <span class="old-price" th:text="${product.OrgPrice}"></span>
                                <span class="new-price" th:text="${product.DiscountedPrice}"></span>
                            </div>
                            <!-- End .price-box -->

<!--                             <div class="product-desc">
                                <span th:text="${product.ProductDescription}"></span>
                            </div> -->
                            <!-- End .product-desc -->

                            <ul class="single-info-list">
                                <!---->



                            </ul>

							<hr class="divider mb-3 mt-0">
                            <div class="selectedOptionsList">
                                <div class="product-single-filter">
								    <label>Size:</label>
								    <ul class="config-size-list">
								        <li class="size" th:each="size : ${prodSize}"><a class="d-flex align-items-center justify-content-center" th:text="${size.size}"></a></li>
								    </ul>
								</div>
								
								<div class="product-single-filter">
								    <label>Color:</label>
								    <ul class="config-size-list">
								        <li class="color" th:each="color : ${prodColor}">
								         <a class="d-flex align-items-center justify-content-center"
								         th:style="'background-color: ' + ${color.color} + '; border-radius: 50%; height: 33px;'">
            							</a></li>
								    </ul>
								</div>

								
								<!-- ì‚¬ì´ì¦ˆ, ìƒ‰ìƒ ì„ íƒí•œ í›„ ì´ˆê¸°í™” ë²„íŠ¼ -->
                                <div class="product-single-filter">
                                    <h5>Selected Options</h5>
                                    <a class="font1 text-uppercase clear-btn" href="#">Clear</a>
                                </div>
                                <!---->
                            </div>


                            <div class="product" data-product-id="${product.productSeq}">
							    <div class="product-action">
							        <div class="product-single-qty">
							            <input class="horizontal-quantity form-control" type="text">
							        </div>
							        <!-- End .product-single-qty -->
							        <a id="addToWishlistButton" class="btn-icon-wish add-wishlist" title="Add to Wishlist" th:href="@{/MyPage/Wishlist}">
							            <i class="icon-wishlist-2"></i>
							            <span>Add to Wishlist</span>
							        </a>
							    </div>
							</div>

                            <!-- End .product-action -->

                            <!-- End .product-action -->
                            
                            <div class="product-single-tabs">
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" id="product-tab-desc" data-toggle="tab" href="#product-desc-content" role="tab" aria-controls="product-desc-content" aria-selected="true">Description</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" id="product-tab-detailDesc" data-toggle="tab" href="#product-detailDesc-content" role="tab" aria-controls="product-detailDesc-content" aria-selected="false">Details</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" id="product-tab-tags" data-toggle="tab" href="#product-tags-content" role="tab" aria-controls="product-tags-content" aria-selected="false">Shippinfo</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" id="product-tab-reviews" data-toggle="tab" href="#product-reviews-content" role="tab" aria-controls="product-reviews-content" aria-selected="false" th:text="'REVIEWS (' + ${product.totalReviewCount} + ')'"></a>
                        </li>
                    </ul>

                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="product-desc-content" role="tabpanel" aria-labelledby="product-tab-desc">
                            <div class="product-desc-content" >
                               <span th:utext="${product.DetailDescription}"></span>
                            </div>
                            <!-- End .product-desc-content -->
                        </div>
                        <!-- End .tab-pane -->

                        <div class="tab-pane fade" id="product-detailDesc-content" role="tabpanel" aria-labelledby="product-tab-detailDesc">
                            <div class="product-detailDesc-content" >
                               <span th:text="'ğŸ§¶Fabric : ' +${product.fabric}"></span>
                               <br>
                               <span th:utext="'ğŸ“Size : ' + ${product.detailSize}"></span>
                            </div>
                            <!-- End .product-detailDesc-content -->
                        </div>
                        
						<!-- ë°°ì†¡ ì •ë³´ > ì´ê±´ ê°’ì— ë”°ë¼ ë‹¬ë¼ì§€ì§€ ì•Šìœ¼ë‹ˆê¹Œ -->
                        <div class="tab-pane fade" id="product-tags-content" role="tabpanel" aria-labelledby="product-tab-tags">
                            <div class="shippinfo-content">
                            <ul>
								<li>ğŸ“ŒIf the total payment is less than 30,000 won, an additional 3,000 won shipping fee will be added.</li>
								<li> ğŸ“ŒFor Jeju or islands and mountains areas, there is no additional cost for the initial order.</li>
								<li> ğŸ“ŒPlease note that an additional delivery fee of KRW 3,000 will be incurred for exchanges and refunds.</li>
								<li> ğŸ“ŒDelivery preparation takes an average of 3-7 business days.</li>
								<li> ğŸ“ŒWe will inform you individually if delivery is delayed, out of stock, or product details change.</li>
                            </ul>
                            </div>
                        </div>
                        <!-- End .tab-pane -->

                        <div class="tab-pane fade" id="product-reviews-content" role="tabpanel" aria-labelledby="product-tab-reviews"  >
						    <div class="product-reviews-content">
						        <h3 class="reviews-title" th:text=" ${product.totalReviewCount == 0 ? 'There is no REVIEW of this product yet' : product.totalReviewCount + ' review for ' + product.ProductName}"></h3>
						        
						        <div class="comment-list" th:if="${product.totalReviewCount > 0}">
						            <div class="comments" th:each="review : ${prodReview}">
						                <figure class="img-thumbnail">
						                    <img src="/usr/images/blog/reviewR.jpg" alt="review" width="80" height="80" >
						                </figure>
						
						                <div class="comment-block mb-1" >
						                    <div class="comment-header">
						                        <div class="comment-arrow"></div>
						                        <!-- ë¦¬ë·° ë³„ì  s -->
						                        <div class="ratings-container float-sm-right">
						                            <div class="product-ratings">
						                                <span class="ratings" th:if="${review.reviewRate==5}" style="width:100%"></span>
						                                <span class="ratings" th:if="${review.reviewRate==4}" style="width:70%"></span>
						                                <span class="ratings" th:if="${review.reviewRate==3}" style="width:50%"></span>
						                                <span class="ratings" th:if="${review.reviewRate==2}" style="width:39%"></span>
						                                <span class="ratings" th:if="${review.reviewRate==1}" style="width:18%"></span>
						                                <!-- ë¦¬ë·° ë³„ì  e -->
						                                <span class="tooltiptext tooltip-top"></span>
						                            </div>
						                            <!-- End .product-ratings -->
						                        </div>
						                        
						                        <span class="comment-by">
						                           <a>â™¥ <strong th:text="${review.revName}"></strong> â€“ <span th:text="${review.revRegDateTime}"></span></a>

						                        </span>
						                    </div>
						
						                    <div class="comment-content">
						                        <a th:text="${review.ReviewContent}"></a>
						                    </div>
						                </div>
						            </div>
						        </div>
						    </div>
						    
                                <div class="divider"></div>
								
                                <div class="add-product-review" th:if="${session.authenticatedMember != null and session.sessSeqUsr != null}">
                                
                                    <h3 class="review-title">Add a review</h3>
                                    
										<form action="ReviewInsert" id="formInsert" name="formInsert" method="post" class="comment-form m-0">
			    
			    							    <!-- form ë‚´ìš© -->
										    <div class="rating-form">
										        <label for="rating">Your rating <span class="required">*</span></label>
										        <!-- ë°‘ì— input ë‘ ê°œëŠ” hiddenìœ¼ë¡œ ë³€ê²½ ì˜ˆì • -->
										        <input type="hidden" name="Product_seq" id="productSeq" th:value="${product.productSeq}">
												<input type="hidden" name="Member_seq" id="memberSeq" th:value="${session.sessSeqUsr}">
			
											        <span class="rating-stars">
													    <a class="star-1" href="#" th:text="${1}" >1</a>
													    <a class="star-2" href="#" th:text="${2}">2</a>
													    <a class="star-3" href="#" th:text="${3}">3</a>
													    <a class="star-4" href="#" th:text="${4}">4</a>
													    <a class="star-5" href="#" th:text="${5}">5</a>
													</span>
																			
										        <select name="reviewRate" id="reviewRate" required style="display: none;">
										            <option value="">Rateâ€¦</option>
										            <option value="5">Perfect</option>
										            <option value="4">Good</option>
										            <option value="3">Average</option>
										            <option value="2">Not that bad</option>
										            <option value="1">Very poor</option>
										        </select>
										    </div>
										    
										    <div class="form-group">
										        <label>Your review <span class="required">*</span></label>
										        <textarea name="ReviewContent" id="ReviewContent" cols="5" rows="6" class="form-control form-control-sm"></textarea>
										        <div class="invalid-feedback" id="ReviewContentFeedback"></div>
										    </div>
			
										    <div class="col-md-12 mb-3">
										        <button type="submit" id="btnAdd" class="btn btn-secondary" style="float: right;">ADD</button>
										    </div>
										</form>

                                </div>
                                <!-- End .add-product-review -->
                                <span th:unless="${session.authenticatedMember != null and session.sessSeqUsr != null}" style="padding-top : 10%;">( <a th:href="@{/recorded/Login}">Login</a> to Add Review)</span>
						</div>

                            </div>
                            <!-- End .product-reviews-content -->
                        </div>
                        <!-- End .tab-pane -->
                    </div>
                    <!-- End .tab-content -->
                </div>
                <!-- End .product-single-tabs -->

                            <!-- End .product single-share -->
                        </div>
                        <!-- End .product-single-details -->
                    </div>
                    <!-- End .row -->
                </div>
                <!-- End .product-single-container -->

                
            </div>
            <!-- End .container -->
        </main>
        <!-- End .main -->
		<div th:replace="~{/usr/infra/v1/include/Footer :: Footer}"></div>


    <!-- Plugins JS File -->
    <script src="/usr/js/jquery.min.js"></script>
    <script src="/usr/js/bootstrap.bundle.min.js"></script>
    <script src="/usr/js/plugins.min.js"></script>

    <!-- Main JS File -->
    <script src="/usr/js/main.min.js"></script>
    
    <script src="/adm/js/validationXdm.js"></script>
    
    <script>
	  //ê°€ê²© ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸
    function formatPriceElements() {
        // HTML ìš”ì†Œë¥¼ ê°€ì ¸ì™€ì„œ ê°€ê²© í¬ë§·íŒ… ì ìš©
        var oldPriceElements = document.querySelectorAll('.old-price');
        var productPriceElements = document.querySelectorAll('.new-price');
        
        oldPriceElements.forEach(function(element) {
            var price = parseFloat(element.textContent);
            element.textContent = formatPrice(price);
        });

        productPriceElements.forEach(function(element) {
            var price = parseFloat(element.textContent);
            element.textContent = formatPrice(price);
        });
    }

    // ê°€ê²© í¬ë§·íŒ… í•¨ìˆ˜
    function formatPrice(price) {
        // ì„¸ ìë¦¬ë§ˆë‹¤ ì»´ë§ˆ ì¶”ê°€
        var formattedPrice = price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        // 'ì›'ì„ ì¶”ê°€í•˜ì—¬ ë°˜í™˜
        return "â‚©" + formattedPrice ;
    }

    // ë¬¸ì„œ ë¡œë“œ í›„ì— ì‹¤í–‰
    document.addEventListener('DOMContentLoaded', function() {
        formatPriceElements();
    });

    // Clear ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì„ íƒí•œ ì˜µì…˜ì„ ì´ˆê¸°í™”
    document.querySelector('.clear-btn').addEventListener('click', function () {
        document.getElementById('selectedOptionsList').innerHTML = '';
    });
    
    $(document).ready(function() {
        $('#btnAdd').click(function(event) {
            // ì…ë ¥ í¼ ìœ íš¨ì„± ê²€ì‚¬
            var reviewContent = $('#ReviewContent').val();
            if (reviewContent.trim() === '') {
                $('#ReviewContent').addClass('is-invalid'); // ë¹¨ê°„ìƒ‰ í…Œë‘ë¦¬ ì¶”ê°€
                $('#ReviewContentFeedback').text('Please select your score and enter the content'); // ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
                event.preventDefault(); // í¼ ì œì¶œ ë°©ì§€
            } else {
                $('#ReviewContent').removeClass('is-invalid'); // ì˜¤ë¥˜ê°€ ì—†ëŠ” ê²½ìš° í…Œë‘ë¦¬ ì œê±°
                $('#ReviewContentFeedback').text(''); // ì˜¤ë¥˜ ë©”ì‹œì§€ ì§€ìš°ê¸°
            }

            // í‰ì  ì„ íƒ ìƒì ìœ íš¨ì„± ê²€ì‚¬
            var reviewRate = $('#reviewRate').val();
            if (reviewRate === '') {
                $('#reviewRate').addClass('is-invalid'); // ë¹¨ê°„ìƒ‰ í…Œë‘ë¦¬ ì¶”ê°€
                event.preventDefault(); // í¼ ì œì¶œ ë°©ì§€
            } else {
                $('#reviewRate').removeClass('is-invalid'); // ì˜¤ë¥˜ê°€ ì—†ëŠ” ê²½ìš° í…Œë‘ë¦¬ ì œê±°
            }
        });
    });

 // ë¦¬ë·° ì œì¶œ
    document.getElementById('formInsert').addEventListener('submit', function(event) {
        event.preventDefault(); 
        

     // ì„¸ì…˜ì— ì €ì¥ëœ íšŒì› ì‹œí€€ìŠ¤ ê°€ì ¸ì˜¤ê¸°
        var memberSeq = sessionStorage.getItem('sessSeqUsr');

        // ì„¸ì…˜ì— ì €ì¥ëœ íšŒì› ì‹œí€€ìŠ¤ ì¶œë ¥
        console.log('ì„¸ì…˜ì— ì €ì¥ëœ íšŒì› ì‹œí€€ìŠ¤:', memberSeq);

        var formData = new FormData(this); // í¼ ë°ì´í„° ê°€ì ¸ì˜´
        
        var productSeq = document.getElementById('productSeq').value;
        var memberSeq = document.getElementById('memberSeq').value;


        // í¼ ë°ì´í„°ì— ë””í´íŠ¸ ê°’ ì¤Œ
        formData.append('delNY', '0');

        var xhr = new XMLHttpRequest(); // AJAX ìš”ì²­ì„ ìƒì„±
        xhr.open('POST', '/ReviewInsert', true); 
        xhr.onreadystatechange = function() {
            if (xhr.readyState === XMLHttpRequest.DONE) { // ìš”ì²­ì´ ì™„ë£Œë˜ë©´
                if (xhr.status === 200) { // ì„±ê³µì ì¸ ì‘ë‹µì„ ë°›ìœ¼ë©´
                    document.getElementById('ReviewContent').value = ''; // ë¦¬ë·° input ì´ˆê¸°í™”
                    location.reload(); // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
                }
            }
        };
        xhr.send(formData); // í¼ ë°ì´í„° ì„œë²„ ì „ì†¡

    $(document).ready(function() {
        $('.add-wishlist').click(function() {
            // í´ë¦­ëœ ë²„íŠ¼ì´ ì†í•œ ìƒí’ˆ ìš”ì†Œì—ì„œ ìƒí’ˆ IDë¥¼ ê°€ì ¸ì˜´
            var productId = $(this).closest('.product').data('productSeq');
            
            // ê°€ì ¸ì˜¨ ìƒí’ˆ IDë¥¼ ì‚¬ìš©í•˜ì—¬ ìœ„ì‹œë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€í•˜ëŠ” ì‘ì—… ìˆ˜í–‰
            addToWishlist(productSeq);
        });
    });
    
    function setReviewRate(rate) {
        review.reviewRate = rate; 
    }
});

</script>
</body>

</html>